<div class="portlet light row">
    <div class="portlet-title">
        <div class="caption font-dark">
            <span class="caption-subject bold uppercase">仪表盘</span>
        </div>
    </div>
    <div ng-controller="DashboardController">
        <div class="row" ng-controller="statsController">
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 dashboard-stat white">
                    <div class="visual">
                        <i class="fa"></i>
                    </div>
                    <div class="details">
                        <div class="number"> {{totalCount}} </div>
                        <div class="desc"> 总数据量</div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 dashboard-stat white">
                    <div class="visual">
                        <i class="fa"></i>
                    </div>
                    <div class="details">
                        <div class="number"> +{{monthCount}} </div>
                        <div class="desc"> 近一月增加</div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 dashboard-stat white">
                    <div class="visual">
                        <i class="fa"></i>
                    </div>
                    <div class="details">
                        <div class="number"> +{{weekCount}} </div>
                        <div class="desc"> 近一周增加</div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 ol-md-6 col-sm-6 col-xs-6">
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 dashboard-stat white">
                    <div class="visual">
                        <i class="fa"></i>
                    </div>
                    <div class="details">
                        <div class="number">{{totalDevice}}</div>
                        <div class="desc"> 总探针设备</div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 dashboard-stat white">
                    <div class="visual">
                        <i class="fa"></i>
                    </div>
                    <div class="details">
                        <div class="number">{{onlineDevice}}</div>
                        <div class="desc"> 在线探针设备</div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 dashboard-stat white">
                    <div class="visual">
                        <i class="fa"></i>
                    </div>
                    <div class="details">
                        <div class="number">+{{weeklyAddDevice}}</div>
                        <div class="desc"> 近一周增加</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-9 col-md-9 col-sm-9 col-xs-9 chart-border" ng-controller="networkController">
                <div class="col-md-12 col-sm-12 col-xs-12">
                    <span class="chart-title">网络操作</span>
                    <span class="divider">|</span>
                    <span class="time-selected" id="network-time-selected"></span>
                    <img class="pull-right bar-charts" src="./icon/bar_chart.png">
                    <img class="pull-right line-charts" src="./icon/line_chart.png">
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 chart-option">
                    <div class="col-md-2 col-sm-2 col-xs-2">
                        <div>
                            <button class="date-range btn-default form-control"
                                    id="network-timerange">今天<span class="caret date-range-caret"></span>
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                        <div class="multi-dropdown"
                             ng-dropdown-multiselect
                             options="selectByGroupData"
                             selected-model="selectByGroupModel"
                             extra-settings="selectByGroupSettings"
                             group-by="group"
                             translation-texts="selectByGroupTexts">
                        </div>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="network-chart" style="height: 300px"></div>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 chart-border" ng-controller="volumeController">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 chart-title">容量</div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="volume-chart" style="height:200px">Loading</div>
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                    <span class="col-lg-12 col-md-12 col-sm-12 col-xs-12 volume">{{StorageUsed}}</span>
                    <span class="col-lg-12 col-md-12 col-sm-12 col-xs-12 volume-des">已用空间</span>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                    <span class="col-lg-12 col-md-12 col-sm-12 col-xs-12 volume">{{StorageTotal}}</span>
                    <span class="col-lg-12 col-md-12 col-sm-12 col-xs-12 volume-des">总空间</span>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 col-md-offset-3 col-sm-offset-3 col-xs-offset-3 btn-manage">
                    <button class="btn-default form-control">管理空间</button>
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 chart-border" ng-controller="systemController">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <span class="chart-title">系统操作</span>
                    <span class="divider">|</span>
                    <span class="time-selected" id="system-time-selected"></span>
                    <img class="pull-right bar-charts" src="./icon/bar_chart.png">
                    <img class="pull-right line-charts" src="./icon/line_chart.png">
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 chart-option">
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                        <div>
                            <button class="date-range btn-default form-control"
                                    id="system-timerange">今天<span class="caret date-range-caret"></span>
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                        <div class="multi-dropdown"
                             ng-dropdown-multiselect
                             options="selectByGroupData"
                             selected-model="selectByGroupModel"
                             extra-settings="selectByGroupSettings"
                             group-by="group"
                             translation-texts="selectByGroupTexts">
                        </div>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="system-chart" style="height: 300px"></div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 chart-border" ng-controller="processController">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <span class="chart-title">进程操作</span>
                    <span class="divider">|</span>
                    <span class="time-selected" id="process-time-selected"></span>
                    <img class="pull-right bar-charts" src="./icon/bar_chart.png">
                    <img class="pull-right line-charts" src="./icon/line_chart.png">
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 chart-option">
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                        <div>
                            <button class="date-range btn-default form-control"
                                    id="process-timerange">今天<span class="caret date-range-caret"></span>
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                        <div class="multi-dropdown"
                             ng-dropdown-multiselect
                             options="selectByGroupData"
                             selected-model="selectByGroupModel"
                             extra-settings="selectByGroupSettings"
                             group-by="group"
                             translation-texts="selectByGroupTexts">
                        </div>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="process-chart" style="height: 300px"></div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 chart-border" ng-controller="fileController">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <span class="chart-title">文件操作</span>
                    <span class="divider">|</span>
                    <span class="time-selected" id="file-time-selected"></span>
                    <img class="pull-right bar-charts" src="./icon/bar_chart.png">
                    <img class="pull-right line-charts" src="./icon/line_chart.png">
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 chart-option">
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                        <div>
                            <button class="date-range btn-default form-control"
                                    id="file-timerange">今天<span class="caret date-range-caret"></span>
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                        <div class="multi-dropdown"
                             ng-dropdown-multiselect
                             options="selectByGroupData"
                             selected-model="selectByGroupModel"
                             extra-settings="selectByGroupSettings"
                             group-by="group"
                             translation-texts="selectByGroupTexts">
                        </div>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="file-chart" style="height: 300px"></div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 chart-border" ng-controller="registryController">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <span class="chart-title">注册表操作</span>
                    <span class="divider">|</span>
                    <span class="time-selected" id="registry-time-selected"></span>
                    <img class="pull-right bar-charts" src="./icon/bar_chart.png">
                    <img class="pull-right line-charts" src="./icon/line_chart.png">
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 chart-option">
                    <div class="col-md-3 col-sm-3 col-xs-3">
                        <div>
                            <button class="date-range btn-default form-control"
                                    id="registry-timerange">今天<span class="caret date-range-caret"></span>
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
                        <div class="multi-dropdown"
                             ng-dropdown-multiselect
                             options="selectByGroupData"
                             selected-model="selectByGroupModel"
                             extra-settings="selectByGroupSettings"
                             group-by="group"
                             translation-texts="selectByGroupTexts">
                        </div>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="registry-chart" style="height: 300px"></div>
            </div>
        </div>

    </div>
</div>
<script src="./assets/global/plugins/bootstrap-daterangepicker/moment.min.js" type="text/javascript"></script>
<script src="./assets/global/plugins/bootstrap-daterangepicker/daterangepicker.js" type="text/javascript"></script>
<!-- BEGIN MAIN CONTENT -->
<script>
    var initialStartTime = moment().startOf('day').format('X');
    var initialEndTime = moment().format('X');

    Date.prototype.format = function (fmt) {
        var o = {
            "M+": this.getMonth() + 1,                 //月份
            "d+": this.getDate(),                    //日
            "h+": this.getHours(),                   //小时
            "m+": this.getMinutes(),                 //分
            "s+": this.getSeconds(),                 //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S": this.getMilliseconds()             //毫秒
        };
        if (/(y+)/.test(fmt)) {
            fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        }
        for (var k in o) {
            if (new RegExp("(" + k + ")").test(fmt)) {
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            }
        }
        return fmt;
    };

    var timeStamp2String = function (time, format) {
        if (typeof(time) == "number") {
            time = time.toString();
        }
        if (time.length != 10 && time.length != 13) {
            return time;
        }
        if (time.length == 10) {
            time = time * 1000;
        }
        var datetime = new Date();
        datetime.setTime(time);
        return datetime.format(format);
    };

    $('#network-time-selected').html(timeStamp2String(initialStartTime, "yyyy-MM-dd hh:mm") + ' 至 ' + timeStamp2String(initialEndTime, "yyyy-MM-dd hh:mm"));
    $('#system-time-selected').html(timeStamp2String(initialStartTime, "yyyy-MM-dd hh:mm") + ' 至 ' + timeStamp2String(initialEndTime, "yyyy-MM-dd hh:mm"));
    $('#process-time-selected').html(timeStamp2String(initialStartTime, "yyyy-MM-dd hh:mm") + ' 至 ' + timeStamp2String(initialEndTime, "yyyy-MM-dd hh:mm"));

    //    $('.networkDatePicker i').click(function () {
    //        $(this).parent().find('input').click();
    //    });

    var getData = function (label) {
        var data = [];
        if (label == "今天") {
            data = ['00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00',
                '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '12:00', '22:00', '23:00' ]
        }
        if (label == "本周") {
            data = ['周一', '周二', '周三', '周四', '周五', '周六', '周日']
        }
        if (label == "本月") {
            data = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15',
                '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31']
        }
        return data;
    };

    var device_info = [];
    function getDeviceInfo() {
        $.ajax({
            async: false,
            url: "deviceinfo",
            type: "GET",
            dataType: "json",
            success: function (data) {
                device_info = data.data
            }
        });
        return device_info;
    }
    device_info = getDeviceInfo();

    function statsController($scope) {
        var device_num;
        $.ajax({
            async: false,
            url: "devicenum",
            type: "GET",
            dataType: "json",
            success: function(data) {
                device_num = data
            }
        });
        var dashboard_sum;
        $.ajax({
            async: false,
            url: "dashboardsum",
            type: "GET",
            dataType: "json",
            success: function(data) {
                dashboard_sum = data
            }
        });
        $scope.totalDevice = device_num.totalnum;
        $scope.onlineDevice = device_num.onlinenum;
        $scope.weeklyAddDevice = device_num.weeknum;
        var formatCount = function(count) {
            if (count < 10000) {
                return count
            }
            else {
                return Math.floor(count / 10000) + "万"
            }
        };
        $scope.totalCount = formatCount(dashboard_sum["total"]);
        $scope.monthCount = formatCount(dashboard_sum["30D"]);
        $scope.weekCount = formatCount(dashboard_sum["7D"]);
    }

    $.ajax({
        async: false,
        url: "dashboardquery",
        type: "POST",
        dataType: "json",
        data: JSON.stringify({
            "eventtype": "3",
            "period": "24H",
            "begintime": "1495098000",
            "endtime": "1495188000",
            "devices": ["all"]
        }),
        success: function(data) {
            console.log('query');
            console.log(JSON.stringify(data));
        }
    });

    function volumeController($scope) {
        var formatVolume = function(volume) {
            var index = volume.indexOf("M");
            var volumeNum = volume.substr(0, index);
            if ((volumeNum / 1024) >= 1) {
                volume = Math.round((volumeNum / 1024)) + "GB";
            }
            return volume
        };

        var disk_info;

        $.ajax({
            async: false,
            url: "diskinfo",
            type: "GET",
            dataType: "json",
            success: function(data) {
                disk_info = data
            }
        });

        $scope.StorageUsed = formatVolume(disk_info.StorageUsed);
        $scope.StorageTotal = formatVolume(disk_info.StorageTotal);
        $scope.StorageUsedPercent = disk_info.StorageUsedPercent;

        var getColor = function(value) {
            if (value < 0.6) {
                result = {
                    value: value,
                    itemStyle: {
                        normal: {
                            color: 'blue'
                        }
                    }
                };
                return result
            }
            if (value >= 0.6 && value < 0.9) {
                result = {
                    value: value,
                    itemStyle: {
                        normal: {
                            color: 'yellow'
                        }
                    }
                };
                return result
            }
            if (value >= 0.9) {
                result = {
                    value: value,
                    itemStyle: {
                        normal: {
                            color: 'red'
                        }
                    }
                };
                return result
            }
        };

        var volumeDraw = function () {
            var dom = document.getElementById("volume-chart");
            var myChart = echarts.init(dom);
            var option = {
                series: [{
                    type: 'liquidFill',
                    radius: '80%',
                    data: [
                        getColor($scope.StorageUsedPercent)
                    ],
                    label: {
                        normal: {
                            textStyle: {
                                color: 'red',
                                insideColor: 'white',
                                fontSize: 50
                            }
                        }
                    }
                }]
            };
            myChart.setOption(option);
        };

        setTimeout(volumeDraw(), 0);
    }

    var networkDraw = function (label) {
        var dom = document.getElementById("network-chart");
        var myChart = echarts.init(dom);
        var xData = getData(label);
        var option = {
            backgroundColor: "#ffffff",
            "tooltip": {
                "trigger": "axis",
                "axisPointer": {
                    "type": "shadow",
                    textStyle: {
                        color: "#fff"
                    }
                }
            },
            "grid": {
                "borderWidth": 0,
                "top": 40,
                "bottom": 50,
                textStyle: {
                    color: "#fff"
                }
            },
            "legend": {
                x: '10%',
                top: '92%',
                textStyle: {
                    color: '#363b4e'
                },
                "data": ['http请求消息', 'http响应消息', 'ftp命令信息', 'ftp应答信息']
            },


            "calculable": true,
            "xAxis": [{
                "type": "category",
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "splitLine": {
                    "show": false
                },
                "axisTick": {
                    "show": false
                },
                "splitArea": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"
                },
                "data": xData
            }],
            "yAxis": [{
                "type": "value",
                "splitLine": {
                    "show": false
                },
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "axisTick": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"
                },
                "splitArea": {
                    "show": false
                }

            }],
            // "dataZoom": [{
            //     "show": true,
            //     "height": 30,
            //     "xAxisIndex": [
            //         0
            //     ],
            //     bottom: 30,
            //     "start": 10,
            //     "end": 80,
            //     handleIcon: 'path://M306.1,413c0,2.2-1.8,4-4,4h-59.8c-2.2,0-4-1.8-4-4V200.8c0-2.2,1.8-4,4-4h59.8c2.2,0,4,1.8,4,4V413z',
            //     handleSize: '110%',
            //     handleStyle:{
            //         color:"#d3dee5",

            //     },
            //       textStyle:{
            //         color:"#fff"},
            //       borderColor:"#90979c"


            // }, {
            //     "type": "inside",
            //     "show": true,
            //     "height": 15,
            //     "start": 1,
            //     "end": 35
            // }],
            "series": [{
                "name": "http请求消息",
                "type": "bar",
                "stack": "总量",
                "barWidth": 10,
                "barGap": "10%",
                "itemStyle": {
                    "normal": {
                        "color": "#ff2925",
                        "label": {
                            "show": false,
                            "textStyle": {
                                "color": "#fff"
                            },
                            "position": "insideTop",
                            formatter: function (p) {
                                return p.value > 0 ? (p.value) : '';
                            }
                        }
                    }
                },
                "data": [
                    198,
                    330,
                    151,
                    160,
                    222,
                    229,
                    128,
                    250,
                    224,
                    473,
                    126,
                    260,
                    198,
                    330,
                    151,
                    160,
                    222,
                    229,
                    128,
                    250,
                    224,
                    473,
                    126,
                    260
                ]
            },

                {
                    "name": "http响应消息",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#7030be",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72,
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                },

                {
                    "name": "ftp命令信息",
                    "type": "bar",
                    "stack": "总量",
                    "barMaxWidth": 35,
                    "barGap": "10%",
                    "itemStyle": {
                        "normal": {
                            "color": "#0096fb",
                            "label": {
                                "show": false,
                                "textStyle": {
                                    "color": "#fff"
                                },
                                "position": "insideTop",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        198,
                        330,
                        151,
                        160,
                        222,
                        229,
                        128,
                        250,
                        224,
                        473,
                        126,
                        260,
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                },

                {
                    "name": "ftp应答信息",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#c8df00",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72,
                        198,
                        330,
                        151,
                        160,
                        222,
                        229,
                        128,
                        250,
                        224,
                        473,
                        126,
                        260
                    ]
                }
            ]
        };

        myChart.setOption(option);
    };

    networkDraw("今天");

    $('#network-timerange').daterangepicker({
        "showCustomRangeLabel": false,
        "autoApply": true,
        "ranges": {
            "今天": [moment().startOf('day'), moment()],
            //            "昨天": [moment().subtract('days', 1).startOf('day'), moment().subtract('days', 1).endOf('day')],
            //            "过去7天": [moment().subtract('days', 6), moment()],
            "本周": [moment().startOf('week'), moment()],
            //            "过去30天": [moment().subtract('days', 29), moment()],
            "本月": [moment().startOf('month'), moment()]
        },
        "locale": {
            "format": "YYYY/MM/DD HH:mm"
        }
    }, function (start, end, label) {
        var startTime = start / 1000;
        var endTime = Math.floor(end / 60000) * 60;
        $("#network-time-selected").html(timeStamp2String(startTime, "yyyy-MM-dd hh:mm") + ' 至 ' + timeStamp2String(endTime, "yyyy-MM-dd hh:mm"));

        networkDraw(label);
    });

    function networkController($scope) {
        $scope.selectByGroupModel = [];

        $scope.selectByGroupData = [];
        $scope.groupInfo = [];
        for (var i = 0; i < device_info.length; i++) {
            var devices = device_info[i].devices;
            $scope.groupInfo.push(device_info[i].groupname);
            for (var k = 0; k < devices.length; k++) {
                var device = {
                    id: devices[k].deviceid,
                    label: devices[k].devicename,
                    group: device_info[i].groupname
                };
                $scope.selectByGroupData.push(device)
            }
        }

        $scope.selectByGroupSettings = {
            selectByGroups: $scope.groupInfo,
            groupByTextProvider: function (groupValue) {
                return groupValue
            },
            scrollableHeight: '400px',
            scrollable: true,
            enableSearch: true
        };

        $scope.selectByGroupTexts = {
            buttonDefaultText: "所有探针设备...",
            selectGroup: '选择所有:',
            allSelectedText: '全部',
            searchPlaceholder: '检索...',
            checkAll: '选择所有',
            uncheckAll: '取消所有选择',
            selectionCount: '被选中'
        };
    }

    function systemController($scope) {
        $scope.selectByGroupModel = [];

        $scope.selectByGroupData = [];
        $scope.groupInfo = [];
        for (var i = 0; i < device_info.length; i++) {
            var devices = device_info[i].devices;
            $scope.groupInfo.push(device_info[i].groupname);
            for (var k = 0; k < devices.length; k++) {
                var device = {
                    id: devices[k].deviceid,
                    label: devices[k].devicename,
                    group: device_info[i].groupname
                };
                $scope.selectByGroupData.push(device)
            }
        }

        $scope.selectByGroupSettings = {
            selectByGroups: $scope.groupInfo,
            groupByTextProvider: function (groupValue) {
                return groupValue
            },
            scrollableHeight: '400px',
            scrollable: true,
            enableSearch: true
        };

        $scope.selectByGroupTexts = {
            buttonDefaultText: "所有探针设备...",
            selectGroup: '选择所有:',
            allSelectedText: '全部',
            searchPlaceholder: '检索...',
            checkAll: '选择所有',
            uncheckAll: '取消所有选择',
            selectionCount: '被选中'
        };
    }

    var systemDraw = function (label) {
        var dom = document.getElementById("system-chart");
        var myChart = echarts.init(dom);
        var xData = getData(label);
        var option = {
            backgroundColor: "#ffffff",
            "tooltip": {
                "trigger": "axis",
                "axisPointer": {
                    "type": "shadow",
                    textStyle: {
                        color: "#fff"
                    }
                }
            },
            "grid": {
                "borderWidth": 0,
                "top": 40,
                "bottom": 50,
                textStyle: {
                    color: "#fff"
                }
            },
            "legend": {
                x: '4%',
                top: '92%',
                textStyle: {
                    color: '#363b4e'
                },
                "data": ['登录', '注销', '修改密码', '移动设备接入', '移动设备拔出']
            },


            "calculable": true,
            "xAxis": [{
                "type": "category",
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "splitLine": {
                    "show": false
                },
                "axisTick": {
                    "show": false
                },
                "splitArea": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"

                },
                "data": xData
            }],
            "yAxis": [{
                "type": "value",
                "splitLine": {
                    "show": false
                },
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "axisTick": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"
                },
                "splitArea": {
                    "show": false
                }

            }],
            // "dataZoom": [{
            //     "show": true,
            //     "height": 30,
            //     "xAxisIndex": [
            //         0
            //     ],
            //     bottom: 30,
            //     "start": 10,
            //     "end": 80,
            //     handleIcon: 'path://M306.1,413c0,2.2-1.8,4-4,4h-59.8c-2.2,0-4-1.8-4-4V200.8c0-2.2,1.8-4,4-4h59.8c2.2,0,4,1.8,4,4V413z',
            //     handleSize: '110%',
            //     handleStyle:{
            //         color:"#d3dee5",

            //     },
            //       textStyle:{
            //         color:"#fff"},
            //       borderColor:"#90979c"


            // }, {
            //     "type": "inside",
            //     "show": true,
            //     "height": 15,
            //     "start": 1,
            //     "end": 35
            // }],
            "series": [{
                "name": "登录",
                "type": "bar",
                "stack": "总量",
                "barWidth": 10,
                "barGap": "10%",
                "itemStyle": {
                    "normal": {
                        "color": "#ff2925",
                        "label": {
                            "show": false,
                            "textStyle": {
                                "color": "#fff"
                            },
                            "position": "insideTop",
                            formatter: function (p) {
                                return p.value > 0 ? (p.value) : '';
                            }
                        }
                    }
                },
                "data": [
                    198,
                    330,
                    151,
                    160,
                    222,
                    229,
                    128,
                    250,
                    224,
                    473,
                    126,
                    260
                ]
            },

                {
                    "name": "注销",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#7030be",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                },

                {
                    "name": "修改密码",
                    "type": "bar",
                    "stack": "总量",
                    "barMaxWidth": 35,
                    "barGap": "10%",
                    "itemStyle": {
                        "normal": {
                            "color": "#0096fb",
                            "label": {
                                "show": false,
                                "textStyle": {
                                    "color": "#fff"
                                },
                                "position": "insideTop",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        198,
                        330,
                        151,
                        160,
                        222,
                        229,
                        128,
                        250,
                        224,
                        473,
                        126,
                        260
                    ]
                },

                {
                    "name": "移动设备接入",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#c8df00",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                },

                {
                    "name": "移动设备拔出",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#f8aa27",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                }
            ]
        };

        myChart.setOption(option);

    };

    systemDraw("今天");

    $('#system-timerange').daterangepicker({
        "showCustomRangeLabel": false,
        "autoApply": true,
        "ranges": {
            "今天": [moment().startOf('day'), moment()],
            //            "昨天": [moment().subtract('days', 1).startOf('day'), moment().subtract('days', 1).endOf('day')],
            //            "过去7天": [moment().subtract('days', 6), moment()],
            "本周": [moment().startOf('week'), moment()],
            //            "过去30天": [moment().subtract('days', 29), moment()],
            "本月": [moment().startOf('month'), moment()]
        },
        "locale": {
            "format": "YYYY/MM/DD HH:mm"
        }
    }, function (start, end, label) {
        var startTime = start / 1000;
        var endTime = Math.floor(end / 60000) * 60;
        $("#system-time-selected").html(timeStamp2String(startTime, "yyyy-MM-dd hh:mm") + ' 至 ' + timeStamp2String(endTime, "yyyy-MM-dd hh:mm"));

        systemDraw(label);
    });

    function processController($scope) {
        $scope.selectByGroupModel = [];

        $scope.selectByGroupData = [];
        $scope.groupInfo = [];
        for (var i = 0; i < device_info.length; i++) {
            var devices = device_info[i].devices;
            $scope.groupInfo.push(device_info[i].groupname);
            for (var k = 0; k < devices.length; k++) {
                var device = {
                    id: devices[k].deviceid,
                    label: devices[k].devicename,
                    group: device_info[i].groupname
                };
                $scope.selectByGroupData.push(device)
            }
        }

        $scope.selectByGroupSettings = {
            selectByGroups: $scope.groupInfo,
            groupByTextProvider: function (groupValue) {
                return groupValue
            },
            scrollableHeight: '400px',
            scrollable: true,
            enableSearch: true
        };

        $scope.selectByGroupTexts = {
            buttonDefaultText: "所有探针设备...",
            selectGroup: '选择所有:',
            allSelectedText: '全部',
            searchPlaceholder: '检索...',
            checkAll: '选择所有',
            uncheckAll: '取消所有选择',
            selectionCount: '被选中'
        };
    }

    var processDraw = function (label) {
        var dom = document.getElementById("process-chart");
        var myChart = echarts.init(dom);
        var xData = getData(label);

        var option = {
            backgroundColor: "#ffffff",
            "tooltip": {
                "trigger": "axis",
                "axisPointer": {
                    "type": "shadow",
                    textStyle: {
                        color: "#fff"
                    }
                }
            },
            "grid": {
                "borderWidth": 0,
                "top": 40,
                "bottom": 50,
                textStyle: {
                    color: "#fff"
                }
            },
            "legend": {
                x: '4%',
                top: '92%',
                left: '25%',
                textStyle: {
                    color: '#363b4e'
                },
                "data": ['创建进程', '终止进程', '加载模块']
            },


            "calculable": true,
            "xAxis": [{
                "type": "category",
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "splitLine": {
                    "show": false
                },
                "axisTick": {
                    "show": false
                },
                "splitArea": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"

                },
                "data": xData
            }],
            "yAxis": [{
                "type": "value",
                "splitLine": {
                    "show": false
                },
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "axisTick": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"
                },
                "splitArea": {
                    "show": false
                }

            }],
            // "dataZoom": [{
            //     "show": true,
            //     "height": 30,
            //     "xAxisIndex": [
            //         0
            //     ],
            //     bottom: 30,
            //     "start": 10,
            //     "end": 80,
            //     handleIcon: 'path://M306.1,413c0,2.2-1.8,4-4,4h-59.8c-2.2,0-4-1.8-4-4V200.8c0-2.2,1.8-4,4-4h59.8c2.2,0,4,1.8,4,4V413z',
            //     handleSize: '110%',
            //     handleStyle:{
            //         color:"#d3dee5",

            //     },
            //       textStyle:{
            //         color:"#fff"},
            //       borderColor:"#90979c"


            // }, {
            //     "type": "inside",
            //     "show": true,
            //     "height": 15,
            //     "start": 1,
            //     "end": 35
            // }],
            "series": [{
                "name": "创建进程",
                "type": "bar",
                "stack": "总量",
                "barWidth": 10,
                "barGap": "10%",
                "itemStyle": {
                    "normal": {
                        "color": "#ff2925",
                        "label": {
                            "show": false,
                            "textStyle": {
                                "color": "#fff"
                            },
                            "position": "insideTop",
                            formatter: function (p) {
                                return p.value > 0 ? (p.value) : '';
                            }
                        }
                    }
                },
                "data": [
                    198,
                    330,
                    151,
                    160,
                    222,
                    229,
                    128,
                    250,
                    224,
                    473,
                    126,
                    260
                ]
            },

                {
                    "name": "终止进程",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#7030be",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                },

                {
                    "name": "加载模块",
                    "type": "bar",
                    "stack": "总量",
                    "barMaxWidth": 35,
                    "barGap": "10%",
                    "itemStyle": {
                        "normal": {
                            "color": "#0096fb",
                            "label": {
                                "show": false,
                                "textStyle": {
                                    "color": "#fff"
                                },
                                "position": "insideTop",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        198,
                        330,
                        151,
                        160,
                        222,
                        229,
                        128,
                        250,
                        224,
                        473,
                        126,
                        260
                    ]
                }
            ]
        };

        myChart.setOption(option);
    };

    processDraw("今天");

    $('#process-timerange').daterangepicker({
        "showCustomRangeLabel": false,
        "autoApply": true,
        "ranges": {
            "今天": [moment().startOf('day'), moment()],
            //            "昨天": [moment().subtract('days', 1).startOf('day'), moment().subtract('days', 1).endOf('day')],
            //            "过去7天": [moment().subtract('days', 6), moment()],
            "本周": [moment().startOf('week'), moment()],
            //            "过去30天": [moment().subtract('days', 29), moment()],
            "本月": [moment().startOf('month'), moment()]
        },
        "locale": {
            "format": "YYYY/MM/DD HH:mm"
        }
    }, function (start, end, label) {
        var startTime = start / 1000;
        var endTime = Math.floor(end / 60000) * 60;
        $("#process-time-selected").html(timeStamp2String(startTime, "yyyy-MM-dd hh:mm") + ' 至 ' + timeStamp2String(endTime, "yyyy-MM-dd hh:mm"));

        processDraw(label);
    });

    function fileController($scope) {
        $scope.selectByGroupModel = [];

        $scope.selectByGroupData = [];
        $scope.groupInfo = [];
        for (var i = 0; i < device_info.length; i++) {
            var devices = device_info[i].devices;
            $scope.groupInfo.push(device_info[i].groupname);
            for (var k = 0; k < devices.length; k++) {
                var device = {
                    id: devices[k].deviceid,
                    label: devices[k].devicename,
                    group: device_info[i].groupname
                };
                $scope.selectByGroupData.push(device)
            }
        }

        $scope.selectByGroupSettings = {
            selectByGroups: $scope.groupInfo,
            groupByTextProvider: function (groupValue) {
                return groupValue
            },
            scrollableHeight: '400px',
            scrollable: true,
            enableSearch: true
        };

        $scope.selectByGroupTexts = {
            buttonDefaultText: "所有探针设备...",
            selectGroup: '选择所有:',
            allSelectedText: '全部',
            searchPlaceholder: '检索...',
            checkAll: '选择所有',
            uncheckAll: '取消所有选择',
            selectionCount: '被选中'
        };
    }

    var fileDraw = function (label) {
        var dom = document.getElementById("file-chart");
        var myChart = echarts.init(dom);
        var xData = getData(label);

        var option = {
            backgroundColor: "#ffffff",
            "tooltip": {
                "trigger": "axis",
                "axisPointer": {
                    "type": "shadow",
                    textStyle: {
                        color: "#fff"
                    }
                }
            },
            "grid": {
                "borderWidth": 0,
                "top": 40,
                "bottom": 50,
                textStyle: {
                    color: "#fff"
                }
            },
            "legend": {
                x: '4%',
                top: '92%',
                textStyle: {
                    color: '#363b4e'
                },
                "data": ['文件打开', '文件关闭', '文件创建', '读文件', '写文件', '删除文件']
            },


            "calculable": true,
            "xAxis": [{
                "type": "category",
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "splitLine": {
                    "show": false
                },
                "axisTick": {
                    "show": false
                },
                "splitArea": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"

                },
                "data": xData
            }],
            "yAxis": [{
                "type": "value",
                "splitLine": {
                    "show": false
                },
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "axisTick": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"
                },
                "splitArea": {
                    "show": false
                }

            }],
            // "dataZoom": [{
            //     "show": true,
            //     "height": 30,
            //     "xAxisIndex": [
            //         0
            //     ],
            //     bottom: 30,
            //     "start": 10,
            //     "end": 80,
            //     handleIcon: 'path://M306.1,413c0,2.2-1.8,4-4,4h-59.8c-2.2,0-4-1.8-4-4V200.8c0-2.2,1.8-4,4-4h59.8c2.2,0,4,1.8,4,4V413z',
            //     handleSize: '110%',
            //     handleStyle:{
            //         color:"#d3dee5",

            //     },
            //       textStyle:{
            //         color:"#fff"},
            //       borderColor:"#90979c"


            // }, {
            //     "type": "inside",
            //     "show": true,
            //     "height": 15,
            //     "start": 1,
            //     "end": 35
            // }],
            "series": [{
                "name": "文件打开",
                "type": "bar",
                "stack": "总量",
                "barWidth": 10,
                "barGap": "10%",
                "itemStyle": {
                    "normal": {
                        "color": "#ff2925",
                        "label": {
                            "show": false,
                            "textStyle": {
                                "color": "#fff"
                            },
                            "position": "insideTop",
                            formatter: function (p) {
                                return p.value > 0 ? (p.value) : '';
                            }
                        }
                    }
                },
                "data": [
                    198,
                    330,
                    151,
                    160,
                    222,
                    229,
                    128,
                    250,
                    224,
                    473,
                    126,
                    260
                ]
            },

                {
                    "name": "文件关闭",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#7030be",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                },

                {
                    "name": "文件创建",
                    "type": "bar",
                    "stack": "总量",
                    "barMaxWidth": 35,
                    "barGap": "10%",
                    "itemStyle": {
                        "normal": {
                            "color": "#0096fb",
                            "label": {
                                "show": false,
                                "textStyle": {
                                    "color": "#fff"
                                },
                                "position": "insideTop",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        198,
                        330,
                        151,
                        160,
                        222,
                        229,
                        128,
                        250,
                        224,
                        473,
                        126,
                        260
                    ]
                },

                {
                    "name": "读文件",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#c8df00",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                },

                {
                    "name": "写文件",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#f8aa27",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                },

                {
                    "name": "删除文件",
                    "type": "bar",
                    "stack": "总量",
                    "itemStyle": {
                        "normal": {
                            "color": "#795548",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                }
            ]
        };

        myChart.setOption(option);
    };

    fileDraw("今天");

    $('#file-timerange').daterangepicker({
        "showCustomRangeLabel": false,
        "autoApply": true,
        "ranges": {
            "今天": [moment().startOf('day'), moment()],
            //            "昨天": [moment().subtract('days', 1).startOf('day'), moment().subtract('days', 1).endOf('day')],
            //            "过去7天": [moment().subtract('days', 6), moment()],
            "本周": [moment().startOf('week'), moment()],
            //            "过去30天": [moment().subtract('days', 29), moment()],
            "本月": [moment().startOf('month'), moment()]
        },
        "locale": {
            "format": "YYYY/MM/DD HH:mm"
        }
    }, function (start, end, label) {
        var startTime = start / 1000;
        var endTime = Math.floor(end / 60000) * 60;
        $("#file-time-selected").html(timeStamp2String(startTime, "yyyy-MM-dd hh:mm") + ' 至 ' + timeStamp2String(endTime, "yyyy-MM-dd hh:mm"));

        fileDraw(label);
    });

    function registryController($scope) {
        $scope.selectByGroupModel = [];

        $scope.selectByGroupData = [];
        $scope.groupInfo = [];
        for (var i = 0; i < device_info.length; i++) {
            var devices = device_info[i].devices;
            $scope.groupInfo.push(device_info[i].groupname);
            for (var k = 0; k < devices.length; k++) {
                var device = {
                    id: devices[k].deviceid,
                    label: devices[k].devicename,
                    group: device_info[i].groupname
                };
                $scope.selectByGroupData.push(device)
            }
        }

        $scope.selectByGroupSettings = {
            selectByGroups: $scope.groupInfo,
            groupByTextProvider: function (groupValue) {
                return groupValue
            },
            scrollableHeight: '400px',
            scrollable: true,
            enableSearch: true
        };

        $scope.selectByGroupTexts = {
            buttonDefaultText: "所有探针设备...",
            selectGroup: '选择所有:',
            allSelectedText: '全部',
            searchPlaceholder: '检索...',
            checkAll: '选择所有',
            uncheckAll: '取消所有选择',
            selectionCount: '被选中'
        };
    }

    var registryDraw = function (label, type) {
        var dom = document.getElementById("registry-chart");
        var myChart = echarts.init(dom);
        var xData = getData(label);

        var option = {
            backgroundColor: "#ffffff",
            "tooltip": {
                "trigger": "axis",
                "axisPointer": {
                    "type": "shadow",
                    textStyle: {
                        color: "#fff"
                    }
                }
            },
            "grid": {
                "borderWidth": 0,
                "top": 40,
                "bottom": 50,
                textStyle: {
                    color: "#fff"
                }
            },
            "legend": {
                x: '4%',
                top: '92%',
                left: '20%',
                textStyle: {
                    color: '#363b4e'
                },
                "data": ['设置键值', '读取键值', '创建键', '删除键']
            },


            "calculable": true,
            "xAxis": [{
                "type": "category",
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "splitLine": {
                    "show": false
                },
                "axisTick": {
                    "show": false
                },
                "splitArea": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"

                },
                "data": xData
            }],
            "yAxis": [{
                "type": "value",
                "splitLine": {
                    "show": false
                },
                "axisLine": {
                    lineStyle: {
                        color: '#363b4e'
                    }
                },
                "axisTick": {
                    "show": false
                },
                "axisLabel": {
                    "interval": "auto"
                },
                "splitArea": {
                    "show": false
                }

            }],
            // "dataZoom": [{
            //     "show": true,
            //     "height": 30,
            //     "xAxisIndex": [
            //         0
            //     ],
            //     bottom: 30,
            //     "start": 10,
            //     "end": 80,
            //     handleIcon: 'path://M306.1,413c0,2.2-1.8,4-4,4h-59.8c-2.2,0-4-1.8-4-4V200.8c0-2.2,1.8-4,4-4h59.8c2.2,0,4,1.8,4,4V413z',
            //     handleSize: '110%',
            //     handleStyle:{
            //         color:"#d3dee5",

            //     },
            //       textStyle:{
            //         color:"#fff"},
            //       borderColor:"#90979c"


            // }, {
            //     "type": "inside",
            //     "show": true,
            //     "height": 15,
            //     "start": 1,
            //     "end": 35
            // }],
            "series": [{
                "name": "设置键值",
                "type": type,
                "stack": "总量1",
                "barWidth": 10,
                "barGap": "10%",
                "itemStyle": {
                    "normal": {
                        "color": "#ff2925",
                        "label": {
                            "show": false,
                            "textStyle": {
                                "color": "#fff"
                            },
                            "position": "insideTop",
                            formatter: function (p) {
                                return p.value > 0 ? (p.value) : '';
                            }
                        }
                    }
                },
                "data": [
                    198,
                    330,
                    151,
                    160,
                    222,
                    229,
                    128,
                    250,
                    224,
                    473,
                    126,
                    260
                ]
            },

                {
                    "name": "读取键值",
                    "type": type,
                    "stack": "总量2",
                    "itemStyle": {
                        "normal": {
                            "color": "#7030be",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                },

                {
                    "name": "创建键",
                    "type": type,
                    "stack": "总量3",
                    "barMaxWidth": 35,
                    "barGap": "10%",
                    "itemStyle": {
                        "normal": {
                            "color": "#0096fb",
                            "label": {
                                "show": false,
                                "textStyle": {
                                    "color": "#fff"
                                },
                                "position": "insideTop",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        198,
                        330,
                        151,
                        160,
                        222,
                        229,
                        128,
                        250,
                        224,
                        473,
                        126,
                        260
                    ]
                },

                {
                    "name": "删除键",
                    "type": type,
                    "stack": "总量4",
                    "itemStyle": {
                        "normal": {
                            "color": "#c8df00",
                            "barBorderRadius": 0,
                            "label": {
                                "show": false,
                                "position": "top",
                                formatter: function (p) {
                                    return p.value > 0 ? (p.value) : '';
                                }
                            }
                        }
                    },
                    "data": [
                        82,
                        67,
                        62,
                        59,
                        67,
                        67,
                        35,
                        71,
                        81,
                        78,
                        79,
                        72
                    ]
                }
            ]
        };

            myChart.setOption(option);
    };

    registryDraw("今天", "line");

    $('#registry-timerange').daterangepicker({
        "showCustomRangeLabel": false,
        "autoApply": true,
        "ranges": {
            "今天": [moment().startOf('day'), moment()],
            //            "昨天": [moment().subtract('days', 1).startOf('day'), moment().subtract('days', 1).endOf('day')],
            //            "过去7天": [moment().subtract('days', 6), moment()],
            "本周": [moment().startOf('week'), moment()],
            //            "过去30天": [moment().subtract('days', 29), moment()],
            "本月": [moment().startOf('month'), moment()]
        },
        "locale": {
            "format": "YYYY/MM/DD HH:mm"
        }
    }, function (start, end, label) {
        var startTime = start / 1000;
        var endTime = Math.floor(end / 60000) * 60;
        $("#registry-time-selected").html(timeStamp2String(startTime, "yyyy-MM-dd hh:mm") + ' 至 ' + timeStamp2String(endTime, "yyyy-MM-dd hh:mm"));

        registryDraw(label);
    });

</script>
<!-- END MAIN CONTENT -->
<!-- BEGIN MAIN JS & CSS -->
<script>
    Dashboard.init();
</script>
<!-- BEGIN MAIN JS & CSS -->